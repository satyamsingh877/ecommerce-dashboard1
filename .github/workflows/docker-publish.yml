name: Docker CI

on:
  push:
    branches: [ main ]

jobs:
  docker:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Docker Login
      env:
        DOCKER_USERNAME: ${{ secrets.DOCKERHUB_USERNAME }}
        DOCKER_PASSWORD: ${{ secrets.DOCKERHUB_TOKEN }}
      run: |
        echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
    
    - name: Build Docker Image
      run: |
        docker build -t satyamsingh877/ecommerce-dashboard1:latest .
        docker tag satyamsingh877/ecommerce-dashboard1:latest satyamsingh877/ecommerce-dashboard1:${{ github.sha }}
    
    - name: Push Docker Image
      run: |
        docker push satyamsingh877/ecommerce-dashboard1:latest
        docker push satyamsingh877/ecommerce-dashboard1:${{ github.sha }}
    
    - name: Success Message
      run: |
        echo "ðŸŽ‰ Docker image pushed successfully!"
        echo ""
        echo "You can now run:"
        echo "docker run -p 9000:9000 satyamsingh877/ecommerce-dashboard1:latest"
        echo ""
        echo "Open: http://localhost:9000"
